(()=>{var t,e={2766:()=>{},5325:()=>{"undefined"==typeof supabase&&console.error("Supabase no está disponible");const t=supabase.createClient("https://orrliwzquwfttjvyhnqt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9ycmxpd3pxdXdmdHRqdnlobnF0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzAwNzUyOTAsImV4cCI6MjA0NTY1MTI5MH0.tyZRlsZC0DhgP3TW_XQmFBgWtJhuJZDx-D5nAGVy3UA");console.log("Supabase client initialized:",t);class e{constructor(){console.log("Initializing DashboardCRM"),this.contacts=[],this.metrics={total:0,pendientes:0,enProceso:0,completados:0},this.currentFilters={status:"todos",type:"todos",search:""},this.handleSearch=this.handleSearch.bind(this),this.handleFilterChange=this.handleFilterChange.bind(this),this.handleTypeFilterChange=this.handleTypeFilterChange.bind(this),this.exportToCSV=this.exportToCSV.bind(this),this.elements={totalContacts:document.getElementById("totalContacts"),pendingContacts:document.getElementById("pendingContacts"),inProcessContacts:document.getElementById("inProcessContacts"),completedContacts:document.getElementById("completedContacts"),searchInput:document.getElementById("searchContacts"),statusFilter:document.getElementById("statusFilter"),typeFilter:document.getElementById("typeFilter"),tableBody:document.querySelector("tbody"),loadingIndicator:document.getElementById("loadingIndicator"),exportButton:document.getElementById("exportButton")},this.init()}async init(){try{console.log("Dashboard init started"),await this.loadInitialData(),this.attachEventListeners(),this.initTooltips(),console.log("Dashboard initialized successfully")}catch(t){console.error("Error in initialization:",t),this.handleError(t,"initialization")}}attachEventListeners(){console.log("Attaching event listeners"),this.elements.searchInput&&this.elements.searchInput.addEventListener("input",this.handleSearch),this.elements.statusFilter&&this.elements.statusFilter.addEventListener("change",this.handleFilterChange),this.elements.typeFilter&&this.elements.typeFilter.addEventListener("change",this.handleTypeFilterChange),this.elements.exportButton&&this.elements.exportButton.addEventListener("click",this.exportToCSV)}async loadInitialData(){try{console.log("Loading initial data");const{data:e,error:n}=await t.from("contactos").select("count");if(console.log("Connection test:",{testData:e,testError:n}),n)throw console.error("Connection test failed:",n),n;await this.applyFilters()}catch(t){this.handleError(t,"loadInitialData")}}async applyFilters(){try{let e=t.from("contactos").select("*");"todos"!==this.currentFilters.status&&(e=e.eq("estado",this.currentFilters.status)),"todos"!==this.currentFilters.type&&(e=e.eq("tipo_usuario",this.currentFilters.type)),this.currentFilters.search&&(e=e.or(`nombre.ilike.%${this.currentFilters.search}%,email.ilike.%${this.currentFilters.search}%`));const{data:n,error:o}=await e;if(o)throw o;console.log("Filtered data:",n),this.contacts=n,this.calculateMetrics(),this.renderContacts(),this.updateMetricsDisplay()}catch(t){this.handleError(t,"applyFilters")}}calculateMetrics(){this.metrics=this.contacts.reduce(((t,e)=>{switch(t.total++,e.estado){case"pendiente":t.pendientes++;break;case"en_proceso":t.enProceso++;break;case"completado":t.completados++}return t}),{total:0,pendientes:0,enProceso:0,completados:0}),console.log("Metrics calculated:",this.metrics)}updateMetricsDisplay(){const{totalContacts:t,pendingContacts:e,inProcessContacts:n,completedContacts:o}=this.elements;t&&(t.textContent=this.metrics.total),e&&(e.textContent=this.metrics.pendientes),n&&(n.textContent=this.metrics.enProceso),o&&(o.textContent=this.metrics.completados)}async renderContacts(){if(!this.elements.tableBody)return;if(this.elements.tableBody.innerHTML='\n      <tr>\n        <td colspan="5" class="text-center">\n          <div class="spinner-border text-primary" role="status">\n            <span class="visually-hidden">Cargando...</span>\n          </div>\n        </td>\n      </tr>\n    ',await new Promise((t=>setTimeout(t,200))),console.log("Rendering contacts:",this.contacts),0===this.contacts.length)return void(this.elements.tableBody.innerHTML='\n        <tr>\n          <td colspan="5" class="text-center text-muted">\n            <i class="fe fe-info me-2"></i>\n            No se encontraron contactos con los filtros actuales\n          </td>\n        </tr>\n      ');const t=this.contacts.map((t=>`\n      <tr>\n        <td class="name">\n          <div class="d-flex align-items-center">\n            <div class="avatar avatar-xs me-2">\n              <span class="avatar-title rounded-circle bg-gray-300">\n                ${(t.nombre||"?")[0].toUpperCase()}\n              </span>\n            </div>\n            <div>\n              <h4 class="font-weight-normal mb-0">${t.nombre||"Sin nombre"}</h4>\n            </div>\n          </div>\n        </td>\n        <td class="email">\n          <span class="text-muted">${t.email}</span>\n        </td>\n        <td class="type text-center">\n          ${this.getUserTypeBadge(t.tipo_usuario)}\n        </td>\n        <td class="status">\n          ${this.getStatusBadge(t.estado)}\n        </td>\n        <td class="text-end">\n          ${this.getActionButtons(t.id)}\n        </td>\n      </tr>\n    `)).join("");this.elements.tableBody.innerHTML=t,this.initTooltips()}getStatusBadge(t){return{pendiente:'<span class="badge text-bg-warning-subtle">Pendiente</span>',en_proceso:'<span class="badge text-bg-info-subtle">En Proceso</span>',completado:'<span class="badge text-bg-success-subtle">Completado</span>',contactado:'<span class="badge text-bg-primary-subtle">Contactado</span>'}[t]||`<span class="badge text-bg-secondary-subtle">${t}</span>`}getUserTypeBadge(t){const e={familiar_preocupado:{icon:"fe fe-users",text:"Familiar",color:"text-primary"},estudiante_crisis:{icon:"fe fe-git-pull-request",text:"Estudiante",color:"text-danger"},explorador_ansioso:{icon:"fe fe-zoom-in",text:"Explorador",color:"text-warning"},buscador_proposito:{icon:"fe fe-star",text:"Profesional",color:"text-success"}}[t]||{icon:"fe fe-help-circle",text:t,color:"text-secondary"};return`\n      <i class="${e.icon} ${e.color}" \n         style="font-size: 1.25rem;"\n         data-bs-toggle="tooltip" \n         data-bs-title="${e.text}"\n         data-bs-placement="top"></i>\n    `}getActionButtons(t){return`\n      <div class="btn-group">\n        <button class="btn btn-sm btn-white d-flex align-items-center" data-action="edit" data-id="${t}">\n          <i class="fe fe-edit-2 me-1"></i>\n          Editar\n        </button>\n        <button class="btn btn-sm btn-white d-flex align-items-center" data-action="view" data-id="${t}">\n          <i class="fe fe-eye me-1"></i>\n          Ver\n        </button>\n      </div>\n    `}handleSearch(t){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((()=>{this.currentFilters.search=t.target.value.toLowerCase(),this.applyFilters()}),300)}async handleFilterChange(t){this.currentFilters.status=t.target.value,await this.applyFilters()}async handleTypeFilterChange(t){this.currentFilters.type=t.target.value,await this.applyFilters()}showNotification(t,e="success"){const n=`\n      <div class="alert alert-${e} alert-dismissible fade show" role="alert">\n        ${t}\n        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>\n      </div>\n    `,o=document.querySelector(".container");if(o){const t=document.createElement("div");t.innerHTML=n,o.insertBefore(t,o.firstChild),setTimeout((()=>{bootstrap.Alert.getOrCreateInstance(t.firstChild).close()}),3e3)}}handleError(t,e=""){console.error(`Error in ${e}:`,t),this.showNotification(`Error: ${t.message||"Ocurrió un error inesperado"}`,"danger")}exportToCSV(){try{if(!this.contacts.length)return void this.showNotification("No hay datos para exportar","warning");const t=[["Nombre","Email","Tipo","Estado","Teléfono"].join(","),...this.contacts.map((t=>[t.nombre||"",t.email||"",t.tipo_usuario||"",t.estado||"",t.telefono||""].join(",")))].join("\n"),e=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download="contactos_profesion_feliz.csv",n.click(),this.showNotification("Datos exportados correctamente")}catch(t){this.handleError(t,"exportToCSV")}}initTooltips(){document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((t=>{"undefined"!=typeof bootstrap&&new bootstrap.Tooltip(t)}))}}document.getElementById("totalContacts")&&(console.log("Initializing DashboardCRM"),window.dashboardCRM=new e)},1192:()=>{const t=document.querySelectorAll("[data-map]");t.forEach((t=>{const e={...{container:t,style:"mapbox://styles/mapbox/light-v9",scrollZoom:!1,interactive:!1},...t.dataset.map?JSON.parse(t.dataset.map):{}};mapboxgl.accessToken="pk.eyJ1IjoiZ29vZHRoZW1lcyIsImEiOiJjanU5eHR4N2cybDU5NGVwOHZwNGprb3E0In0.msdw9q16dh8v4azJXUdiXg",new mapboxgl.Map(e)}))},2579:()=>{function t(){document.documentElement.style.overflowX="visible"}function e(){document.documentElement.style.overflowX=""}document.querySelectorAll(".modal").forEach((n=>{n.addEventListener("show.bs.modal",t),n.addEventListener("hidden.bs.modal",e)}))},5570:()=>{const t=document.querySelectorAll(".navbar-nav .dropdown, .navbar-nav .dropend"),e=["mouseenter","focusin"],n=["mouseleave","click","focusout"];t.forEach((function(t){const o=t.querySelector(".dropdown-menu");e.forEach((function(e){t.addEventListener(e,(function(){!function(t){window.innerWidth<992||(t.classList.add("showing"),setTimeout((function(){t.classList.remove("showing"),t.classList.add("show")}),1))}(o)}))})),n.forEach((function(e){t.addEventListener(e,(function(t){!function(t,e){setTimeout((function(){window.innerWidth<992||e.classList.contains("show")&&("click"===t.type&&t.target.closest(".dropdown-menu form")||(e.classList.add("showing"),e.classList.remove("show"),setTimeout((function(){e.classList.remove("showing")}),200)))}),2)}(t,o)}))}))}))},1106:()=>{const t=document.querySelectorAll(".navbar-togglable"),e=document.querySelectorAll(".navbar-collapse"),n=["load","scroll"];let o=!1;function a(t){const e=window.pageYOffset;e&&!o&&function(t){t.classList.remove("navbar-dark"),t.classList.add("navbar-light"),t.classList.add("bg-white"),o=!0}(t),e||function(t){t.classList.remove("navbar-light"),t.classList.remove("bg-white"),t.classList.add("navbar-dark"),o=!1}(t)}function s(){const t=window.innerWidth-document.documentElement.clientWidth;document.documentElement.style.overflow="hidden",document.body.style.paddingRight=t+"px"}t.forEach((function(t){n.forEach((function(e){window.addEventListener(e,(function(){a(t)}))}))})),e.forEach((function(t){t.addEventListener("show.bs.collapse",(function(){s()})),t.addEventListener("hidden.bs.collapse",(function(){document.documentElement.style.overflow="",document.body.style.paddingRight=""}))}))},8852:(t,e,n)=>{"use strict";var o=n(9336),a=n(2522),s=n.n(a),i=(n(5551),n(5839),n(5307),n(1989)),r=n(4042),l=n.n(r);l().init({duration:700,easing:"ease-out-quad",once:!0,startEvent:"load"}),window.AOS=l();var c=n(8634);document.querySelectorAll("[data-bigpicture]").forEach((function(t){t.addEventListener("click",(function(e){e.preventDefault();const n=JSON.parse(t.dataset.bigpicture),o={...{el:t,noLoader:!0},...n};(0,c.A)(o)}))})),window.BigPicture=c.A,window.Alert=o.Fc,window.Button=o.$n,window.Carousel=o.FN,window.Collapse=o.SD,window.Dropdown=o.ms,window.Modal=o.aF,window.Offcanvas=o.go,window.Popover=o.AM,window.ScrollSpy=o.I6,window.Tab=o.oz,window.Toast=o.y8,window.Tooltip=o.m_;var d=n(8019),u=n.n(d);document.querySelectorAll("[data-choices]").forEach((t=>{const e={...t.dataset.choices?JSON.parse(t.dataset.choices):{},...{shouldSort:!1,searchEnabled:!1,classNames:{containerInner:t.className,input:"form-control",inputCloned:"form-control-xs",listDropdown:"dropdown-menu",itemChoice:"dropdown-item",activeState:"show",selectedState:"active"}}};new(u())(t,e)})),window.Choices=u();var h=n(6991);function p(t){const e=t.dataset.to?+t.dataset.to:null,n=t.dataset.countup?JSON.parse(t.dataset.countup):{};new h.T(t,e,n).start()}document.querySelectorAll("[data-countup]").forEach((t=>{"countup:in"!==t.getAttribute("data-aos-id")&&p(t)})),document.addEventListener("aos:in:countup:in",(function(t){(t.detail instanceof Element?[t.detail]:document.querySelectorAll('.aos-animate[data-aos-id="countup:in"]:not(.counted)')).forEach((t=>{p(t)}))})),window.CountUp=h.T;var m=n(2628),f=n.n(m);f().autoDiscover=!1,f().thumbnailWidth=null,f().thumbnailHeight=null;document.querySelectorAll("[data-dropzone]").forEach((t=>{let e;const n=t.dataset.dropzone?JSON.parse(t.dataset.dropzone):{},o={previewsContainer:t.querySelector(".dz-preview"),previewTemplate:t.querySelector(".dz-preview").innerHTML,init:function(){this.on("addedfile",(function(t){1==n.maxFiles&&e&&this.removeFile(e),e=t}))}},a={...n,...o};t.querySelector(".dz-preview").innerHTML="",new(f())(t,a)})),window.Dropzone=f(),window.Flickity=s();var g=n(11),w=n(5603),y=n(9359);const b=document.querySelectorAll(".highlight");g.A.registerLanguage("xml",y.A),g.A.registerLanguage("javascript",w.A),b.forEach((t=>{g.A.highlightBlock(t)})),window.hljs=g.A;var v=n(7943),E=n.n(v),S=n(6334),x=n.n(S);const C=document.querySelectorAll("[data-isotope]"),T=document.querySelectorAll("[data-filter]");C.forEach((function(t){E()(t,(function(){const e=JSON.parse(t.dataset.isotope);new(x())(t,e)}))})),T.forEach((function(t){t.addEventListener("click",(function(e){e.preventDefault();const n=t.dataset.filter,o=t.dataset.bsTarget;x().data(o).arrange({filter:n})}))})),window.Isotope=x(),window.imagesLoaded=E();const F=document.querySelectorAll("[data-jarallax], [data-jarallax-element]");(0,i.nk)(),(0,i.yy)(),(0,i.c1)(F),window.jarallax=i.c1,window.jarallaxElement=i.yy,window.jarallaxVideo=i.nk;n(1192),n(2579),n(5570),n(1106);document.querySelectorAll('[data-bs-toggle="popover"]').forEach((t=>{new o.AM(t)}));const A=document.querySelectorAll('[data-toggle="price"]');A.forEach((t=>{t.addEventListener("change",(t=>{const e=t.target,n=e.checked,o=e.dataset.target;document.querySelectorAll(o).forEach((t=>{const e=t.dataset.annual,o=t.dataset.monthly,a=t.dataset.options?JSON.parse(t.dataset.options):{};a.startVal=n?e:o,a.duration=a.duration?a.duration:1;(n?new h.T(t,o,a):new h.T(t,e,a)).start()}))}))}));var L=n(1574),I=n.n(L);document.querySelectorAll("[data-quill]").forEach((t=>{const e={modules:{toolbar:[["bold","italic"],["link","blockquote","code","image"],[{list:"ordered"},{list:"bullet"}]]},theme:"snow",...t.dataset.quill?JSON.parse(t.dataset.quill):{}};new(I())(t,e)})),window.Quill=I();var q=n(1496),O=n.n(q);const B={header:".navbar.fixed-top",offset:function(t,e){return e.dataset.scroll&&void 0!==JSON.parse(e.dataset.scroll).offset?JSON.parse(e.dataset.scroll).offset:24}};new(O())("[data-scroll]",B),window.SmoothScroll=O();document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach((t=>{new o.m_(t)}));var k=n(2902);document.querySelectorAll("[data-typed]").forEach((t=>{const e={typeSpeed:40,backSpeed:40,backDelay:1e3,loop:!0,...t.dataset.typed?JSON.parse(t.dataset.typed):{}};new k.A(t,e)})),window.Typed=k.A;n(5325)}},n={};function o(t){var a=n[t];if(void 0!==a)return a.exports;var s=n[t]={exports:{}};return e[t].call(s.exports,s,s.exports,o),s.exports}o.m=e,t=[],o.O=(e,n,a,s)=>{if(!n){var i=1/0;for(d=0;d<t.length;d++){for(var[n,a,s]=t[d],r=!0,l=0;l<n.length;l++)(!1&s||i>=s)&&Object.keys(o.O).every((t=>o.O[t](n[l])))?n.splice(l--,1):(r=!1,s<i&&(i=s));if(r){t.splice(d--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[n,a,s]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={694:0};o.O.j=e=>0===t[e];var e=(e,n)=>{var a,s,[i,r,l]=n,c=0;if(i.some((e=>0!==t[e]))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(l)var d=l(o)}for(e&&e(n);c<i.length;c++)s=i[c],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(d)},n=self.webpackChunklandkit=self.webpackChunklandkit||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),o.O(void 0,[121],(()=>o(8852)));var a=o.O(void 0,[121],(()=>o(2766)));a=o.O(a)})();
//# sourceMappingURL=theme.bundle.js.map